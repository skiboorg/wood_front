<script setup lang="ts">
const links = [
  {label:'Главная',url:'/'},
  {label:'О нас',url:'/about'},
  {label:'Оплата и доставка',url:'/'},
  {label:'Услуги',url:'/'},
  {label:'Статьи',url:'/'},
  {label:'Контакты',url:'/contacts'},
]

const route = useRoute()
const q = ref(null)
const visible= ref(false)
const is_index = computed(()=>route.fullPath === '/')

const keyDown = async (key) => {
  if (!q.value) return
  if (key.keyCode === 13) {
    await navigateTo(`/search?q=${q.value}`, { replace: true });
  }
}
watch(() => route.fullPath, () => {
  console.log('route change')
  visible.value = false
});

</script>

<template>
  <div class="container">
    <header :class="is_index ? 'text-white' : 'text-black'" class=" relative z-10">
      <div class="hidden md:flex items-center justify-between py-6">
        <div class="flex gap-4 ">
          <nuxt-link :to="link.url" v-for="link in links">{{link.label}}</nuxt-link>
        </div>
        <div class="flex gap-4 ">
          <p>Москва</p>
          <a href="tel:+7 495 008 88-81">+7 495 008 88-81</a>
          <p> Круглосуточно 24/7</p>
        </div>
      </div>
      <div class="flex items-center justify-between gap-4 py-3 md:py-0">
        <nuxt-link to="/">
          <svg v-if="is_index" width="187" height="48" viewBox="0 0 187 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M32.2327 31.9897L49.0789 2.1546H64.283L40.5646 45.787H23.536L0 2.1546H16.2988L32.2327 31.9897Z" fill="#FF550A"/>
            <path d="M97.9339 19.8434C101.907 19.8434 105.374 20.1186 108.334 20.6689C111.334 21.1799 113.827 22.3002 115.814 24.0298C117.841 25.7593 118.855 28.2751 118.855 31.577C118.855 37.6698 116.057 41.7972 110.462 43.9591C104.908 46.0818 98.6637 47.1431 91.7306 47.1431C84.8381 47.1431 78.4524 46.0621 72.5735 43.9002C66.6945 41.6989 63.7551 37.5322 63.7551 31.4001L79.2633 31.3411C79.2633 34.0534 80.5201 35.783 83.0339 36.5299C85.5882 37.2374 88.5682 37.5912 91.9739 37.5912C95.1769 37.5912 97.9137 37.1391 100.184 36.235C102.495 35.3309 103.651 33.8569 103.651 31.8128V31.7539C103.651 30.6139 102.941 29.7688 101.522 29.2185C100.103 28.6682 98.5826 28.334 96.9609 28.2161C95.3391 28.0982 93.393 28.0196 91.1225 27.9803H86.5612C82.1825 27.9803 78.3713 27.7248 75.1278 27.2137C71.9248 26.6634 69.2286 25.4842 67.0392 23.676C64.8498 21.8678 63.7551 19.1948 63.7551 15.6571C63.7551 9.52494 66.5932 5.53513 72.2694 3.68763C77.9861 1.80082 84.4732 0.857422 91.7306 0.857422C98.5421 0.857422 104.766 1.9384 110.401 4.10037C116.037 6.26234 118.855 10.429 118.855 16.6005H103.59C103.59 14.635 102.434 13.1806 100.123 12.2372C97.8528 11.2545 95.0756 10.7042 91.7915 10.5863C88.2641 10.5863 85.2841 10.9794 82.8514 11.7655C80.4188 12.5517 79.2025 13.7899 79.2025 15.4802C79.2025 17.2491 80.4391 18.4283 82.9123 19.0179C85.3855 19.6076 88.183 19.9024 91.3049 19.9024L97.9339 19.8434Z" fill="#FF550A"/>
            <path d="M186.923 2.1546V45.787H171.962V26.0935L162.049 45.787H148.244L137.662 25.8576V45.787H122.64V2.1546H139.79L155.116 32.1666L170.199 2.1546H186.923Z" fill="#FF550A"/>
            <path d="M32.2327 31.9884L40.5646 45.7857H23.536L0 2.15332H16.2988L32.2327 31.9884Z" fill="white"/>
          </svg>
          <svg v-else width="187" height="48" viewBox="0 0 187 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M32.2327 31.9892L49.0789 2.15411H64.283L40.5646 45.7865H23.536L0 2.15411H16.2988L32.2327 31.9892Z" fill="#FF550A"/>
            <path d="M97.9339 19.8429C101.907 19.8429 105.374 20.1181 108.334 20.6684C111.334 21.1794 113.827 22.2997 115.814 24.0293C117.841 25.7588 118.855 28.2746 118.855 31.5765C118.855 37.6693 116.057 41.7967 110.462 43.9587C104.908 46.0813 98.6637 47.1426 91.7306 47.1426C84.8381 47.1426 78.4524 46.0617 72.5735 43.8997C66.6945 41.6984 63.7551 37.5317 63.7551 31.3996L79.2633 31.3406C79.2633 34.0529 80.5201 35.7825 83.0339 36.5294C85.5882 37.2369 88.5682 37.5907 91.9739 37.5907C95.1769 37.5907 97.9137 37.1386 100.184 36.2346C102.495 35.3305 103.651 33.8564 103.651 31.8123V31.7534C103.651 30.6134 102.941 29.7683 101.522 29.218C100.103 28.6677 98.5826 28.3335 96.9609 28.2156C95.3391 28.0977 93.393 28.0191 91.1225 27.9798H86.5612C82.1825 27.9798 78.3713 27.7243 75.1278 27.2133C71.9248 26.6629 69.2286 25.4837 67.0392 23.6755C64.8498 21.8673 63.7551 19.1943 63.7551 15.6566C63.7551 9.52445 66.5932 5.53464 72.2694 3.68714C77.9861 1.80034 84.4732 0.856934 91.7306 0.856934C98.5421 0.856934 104.766 1.93792 110.401 4.09988C116.037 6.26185 118.855 10.4285 118.855 16.6H103.59C103.59 14.6345 102.434 13.1801 100.123 12.2367C97.8528 11.254 95.0756 10.7037 91.7915 10.5858C88.2641 10.5858 85.2841 10.9789 82.8514 11.765C80.4188 12.5512 79.2025 13.7894 79.2025 15.4797C79.2025 17.2486 80.4391 18.4278 82.9123 19.0174C85.3855 19.6071 88.183 19.9019 91.3049 19.9019L97.9339 19.8429Z" fill="#FF550A"/>
            <path d="M186.923 2.15411V45.7865H171.962V26.093L162.049 45.7865H148.244L137.662 25.8571V45.7865H122.64V2.15411H139.79L155.116 32.1661L170.199 2.15411H186.923Z" fill="#FF550A"/>
            <path d="M32.2327 31.988L40.5646 45.7852H23.536L0 2.15283H16.2988L32.2327 31.988Z" fill="#534439"/>
          </svg>


        </nuxt-link>




        <IconField class="hidden md:block " style="flex-grow: 1">
          <InputText class="" style="border-radius: 30px;width: 100%" v-model="q" placeholder="Поиск по сайту VSM" @keydown="keyDown"/>
          <InputIcon class="pi pi-search" />

        </IconField>
        <Button @click="visible=true" class="block md:!hidden" rounded icon="pi pi-bars"  />
        <nuxt-link class="hidden md:block" to="/catalog">
          <Button  rounded  label="Каталог" />
        </nuxt-link>
        <div class="hidden md:block">
          <a href="tel:+7 495 008 88-81" target="_blank" class="p-button p-component p-button-secondary p-button-rounded  !text-black">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M16.5001 12.6901V14.9401C16.5009 15.1489 16.4581 15.3557 16.3745 15.5471C16.2908 15.7385 16.168 15.9103 16.0141 16.0515C15.8602 16.1927 15.6785 16.3002 15.4806 16.3671C15.2828 16.434 15.0731 16.4589 14.8651 16.4401C12.5572 16.1893 10.3403 15.4007 8.39257 14.1376C6.58044 12.9861 5.04407 11.4497 3.89257 9.63757C2.62506 7.68098 1.83625 5.45332 1.59007 3.13507C1.57133 2.92767 1.59598 2.71864 1.66245 2.52129C1.72892 2.32394 1.83575 2.14259 1.97615 1.98879C2.11654 1.83499 2.28743 1.7121 2.47792 1.62796C2.6684 1.54382 2.87433 1.50027 3.08257 1.50007H5.33257C5.69655 1.49649 6.04942 1.62538 6.32539 1.86272C6.60137 2.10006 6.78163 2.42966 6.83257 2.79007C6.92754 3.51012 7.10366 4.21712 7.35757 4.89757C7.45848 5.16602 7.48032 5.45776 7.4205 5.73823C7.36069 6.01871 7.22172 6.27616 7.02007 6.48007L6.06757 7.43257C7.13524 9.31023 8.68991 10.8649 10.5676 11.9326L11.5201 10.9801C11.724 10.7784 11.9814 10.6395 12.2619 10.5796C12.5424 10.5198 12.8341 10.5417 13.1026 10.6426C13.783 10.8965 14.49 11.0726 15.2101 11.1676C15.5744 11.219 15.9071 11.4025 16.145 11.6832C16.3828 11.9639 16.5092 12.3223 16.5001 12.6901Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            +7 495 008 88-81
          </a>
        </div>

      </div>

    </header>
  </div>
  <Drawer v-model:visible="visible" position="right" header=" ">


    <div class="flex flex-col gap-4 ">
      <p>Москва</p>
      <a href="tel:+7 495 008 88-81">+7 495 008 88-81</a>
      <p> Круглосуточно 24/7</p>
      <nuxt-link to="/catalog">
        <Button fluid rounded icon="pi pi-bars" label="Каталог" />
      </nuxt-link>
      <nuxt-link :to="link.url" v-for="link in links">{{link.label}}</nuxt-link>

      <IconField  style="flex-grow: 1">
        <InputText style="border-radius: 30px;width: 100%" v-model="q" placeholder="Поиск по сайту VSM" @keydown="keyDown"/>
        <InputIcon class="pi pi-search" />
      </IconField>

    </div>

 </Drawer>
</template>

<style scoped>

</style>